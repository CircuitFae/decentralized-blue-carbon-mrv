// scripts/deploy.js
import { ethers } from 'ethers';
import dotenv from 'dotenv';
import fs from 'fs';

dotenv.config();

// --- CONTRACT DETAILS ---
const registryABI = JSON.parse(fs.readFileSync('../server/contracts/BlueCarbonRegistry.json', 'utf8'));
const marketplaceABI = JSON.parse(fs.readFileSync('../server/contracts/CarbonCreditMarketplace.json', 'utf8'));

// Make sure you have pasted the correct bytecode for both contracts
const registryBytecode = '608060405234801561000f575f5ffd5b50336040518060400160405280601281526020017f426c756520436172626f6e2043726564697400000000000000000000000000008152506040518060400160405280600381526020017f4243430000000000000000000000000000000000000000000000000000000000815250815f908161008b9190610423565b50806001908161009b9190610423565b5050505f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff160361010e575f6040517f1e4fbdf70000000000000000000000000000000000000000000000000000000081526004016101059190610531565b60405180910390fd5b61011d8161012360201b60201c565b5061054a565b5f60075f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690508160075f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b5f81519050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f600282049050600182168061026157607f821691505b6020821081036102745761027361021d565b5b50919050565b5f819050815f5260205f209050919050565b5f6020601f8301049050919050565b5f82821b905092915050565b5f600883026102d67fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8261029b565b6102e0868361029b565b95508019841693508086168417925050509392505050565b5f819050919050565b5f819050919050565b5f61032461031f61031a846102f8565b610301565b6102f8565b9050919050565b5f819050919050565b61033d8361030a565b6103516103498261032b565b8484546102a7565b825550505050565b5f5f905090565b610368610359565b610373818484610334565b505050565b5b818110156103965761038b5f82610360565b600181019050610379565b5050565b601f8211156103db576103ac8161027a565b6103b58461028c565b810160208510156103c4578190505b6103d86103d08561028c565b830182610378565b50505b505050565b5f82821c905092915050565b5f6103fb5f19846008026103e0565b1980831691505092915050565b5f61041383836103ec565b9150826002028217905092915050565b61042c826101e6565b67ffffffffffffffff811115610445576104446101f0565b5b61044f825461024a565b61045a82828561039a565b5f60209050601f83116001811461048b575f8415610479578287015190505b6104838582610408565b8655506104ea565b601f1984166104998661027a565b5f5b828110156104c05784890151825560018201915060208501945060208101905061049b565b868310156104dd57848901516104d9601f8916826103ec565b8355505b6001600288020188555050505b505050505050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61051b826104f2565b9050919050565b61052b81610511565b82525050565b5f6020820190506105445f830184610522565b92915050565b612f65806105575f395ff3fe608060405234801561000f575f5ffd5b5060043610610135575f3560e01c8063715018a6116100b6578063a22cb4651161007a578063a22cb4651461034e578063b88d4fde1461036a578063c87b56dd14610386578063d11d498b146103b6578063e985e9c5146103d2578063f2fde38b1461040257610135565b8063715018a6146102bc57806373096dd0146102c65780638da5cb5b146102e2578063911d25521461030057806395d89b411461033057610135565b8063177b3010116100fd578063177b30101461020857806323b872dd1461022457806342842e0e146102405780636352211e1461025c57806370a082311461028c57610135565b806301ffc9a71461013957806306fdde0314610169578063081812fc14610187578063095ea7b3146101b7578063107046bd146101d3575b5f5ffd5b610153600480360381019061014e91906120c9565b61041e565b604051610160919061210e565b60405180910390f35b61017161042f565b60405161017e9190612197565b60405180910390f35b6101a1600480360381019061019c91906121ea565b6104be565b6040516101ae9190612254565b60405180910390f35b6101d160048036038101906101cc9190612297565b6104d9565b005b6101ed60048036038101906101e891906121ea565b6104ef565b6040516101ff96959493929190612357565b60405180910390f35b610222600480360381019061021d91906124f0565b61065f565b005b61023e60048036038101906102399190612566565b6107ed565b005b61025a60048036038101906102559190612566565b6108ec565b005b610276600480360381019061027191906121ea565b61090b565b6040516102839190612254565b60405180910390f35b6102a660048036038101906102a191906125b6565b61091c565b6040516102b391906125e1565b60405180910390f35b6102c46109d2565b005b6102e060048036038101906102db91906125fa565b6109e5565b005b6102ea610bc6565b6040516102f79190612254565b60405180910390f35b61031a600480360381019061031591906121ea565b610bee565b60405161032791906125e1565b60405180910390f35b610338610c03565b6040516103459190612197565b60405180910390f35b61036860048036038101906103639190612690565b610c93565b005b610384600480360381019061037f919061276c565b610ca9565b005b6103a0600480360381019061039b91906121ea565b610cce565b6040516103ad9190612197565b60405180910390f35b6103d060048036038101906103cb919061280f565b610ce0565b005b6103ec60048036038101906103e7919061284d565b610dbb565b6040516103f9919061210e565b60405180910390f35b61041c600480360381019061041791906125b6565b610e49565b005b5f61042882610ecd565b9050919050565b60605f805461043d906128b8565b80601f0160208091040260200160405190810160405280929190818152602001828054610469906128b8565b80156104b45780601f1061048b576101008083540402835291602001916104b4565b820191905f5260205f20905b81548152906001019060200180831161049757829003601f168201915b5050505050905090565b5f6104c882610f2d565b506104d282610fb3565b9050919050565b6104eb82826104e6610fec565b610ff3565b5050565b600a602052805f5260405f205f91509050805f015490806001018054610514906128b8565b80601f0160208091040260200160405190810160405280929190818152602001828054610540906128b8565b801561058b5780601f106105625761010080835404028352916020019161058b565b820191905f5260205f20905b81548152906001019060200180831161056e57829003601f168201915b5050505050908060020180546105a0906128b8565b80601f01602080910402602001604051908101604052809291908181526020018280546105cc906128b8565b80156106175780601f106105ee57610100808354040283529160200191610617565b820191905f5260205f20905b8154815290600101906020018083116105fa57829003601f168201915b505050505090806003015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060030160149054906101000a900460ff16908060040154905086565b60085f81548092919061067190612915565b91905055505f60085490506040518060c001604052808281526020018481526020018381526020013373ffffffffffffffffffffffffffffffffffffffff1681526020015f60048111156106c8576106c76122e4565b5b815260200142815250600a5f8381526020019081526020015f205f820151815f015560208201518160010190816106ff9190612afc565b5060408201518160020190816107159190612afc565b506060820151816003015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060808201518160030160146101000a81548160ff02191690836004811115610787576107866122e4565b5b021790555060a082015181600401559050503373ffffffffffffffffffffffffffffffffffffffff16817fbe67d123666fdaa12bddfaf9f13056f83522df7149a1717d7ba91baf586cfcc8856040516107e09190612197565b60405180910390a3505050565b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff160361085d575f6040517f64a0ae920000000000000000000000000000000000000000000000000000000081526004016108549190612254565b60405180910390fd5b5f610870838361086b610fec565b611005565b90508373ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16146108e6578382826040517f64283d7b0000000000000000000000000000000000000000000000000000000081526004016108dd93929190612bcb565b60405180910390fd5b50505050565b61090683838360405180602001604052805f815250610ca9565b505050565b5f61091582610f2d565b9050919050565b5f5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff160361098d575f6040517f89c62b640000000000000000000000000000000000000000000000000000000081526004016109849190612254565b60405180910390fd5b60035f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20549050919050565b6109da611210565b6109e35f611297565b565b6109ed611210565b5f600a5f8581526020019081526020015f2090505f815f015403610a46576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610a3d90612c4a565b60405180910390fd5b60026004811115610a5a57610a596122e4565b5b8160030160149054906101000a900460ff166004811115610a7e57610a7d6122e4565b5b14610abe576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610ab590612cb2565b60405180910390fd5b5f8311610b00576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610af790612d1a565b60405180910390fd5b5f5f90505b83811015610bbf5760095f815480929190610b1f90612915565b91905055505f6009549050610b57836003015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff168261135a565b610b618185611377565b85600b5f8381526020019081526020015f208190555080867f4b8381ebf17730292bb93febac181b300ac1700946808355ba052c5f3b492ca06001604051610ba99190612d71565b60405180910390a3508080600101915050610b05565b5050505050565b5f60075f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b600b602052805f5260405f205f915090505481565b606060018054610c12906128b8565b80601f0160208091040260200160405190810160405280929190818152602001828054610c3e906128b8565b8015610c895780601f10610c6057610100808354040283529160200191610c89565b820191905f5260205f20905b815481529060010190602001808311610c6c57829003601f168201915b5050505050905090565b610ca5610c9e610fec565b83836113d1565b5050565b610cb48484846107ed565b610cc8610cbf610fec565b8585858561153a565b50505050565b6060610cd9826116e6565b9050919050565b610ce8611210565b5f600a5f8481526020019081526020015f2090505f815f015403610d41576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610d3890612c4a565b60405180910390fd5b818160030160146101000a81548160ff02191690836004811115610d6857610d676122e4565b5b0217905550827f8fb6fda973f304b2834c4147004045448416c05b253872373ac5b19f4a5b7a5d8260030160149054906101000a900460ff16604051610dae9190612d8a565b60405180910390a2505050565b5f60055f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16905092915050565b610e51611210565b5f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610ec1575f6040517f1e4fbdf7000000000000000000000000000000000000000000000000000000008152600401610eb89190612254565b60405180910390fd5b610eca81611297565b50565b5f634906490660e01b7bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19161480610f265750610f25826117f1565b5b9050919050565b5f5f610f38836118d2565b90505f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610faa57826040517f7e273289000000000000000000000000000000000000000000000000000000008152600401610fa191906125e1565b60405180910390fd5b80915050919050565b5f60045f8381526020019081526020015f205f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b5f33905090565b611000838383600161190b565b505050565b5f5f611010846118d2565b90505f73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff161461105157611050818486611aca565b5b5f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16146110dc576110905f855f5f61190b565b600160035f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f82825403925050819055505b5f73ffffffffffffffffffffffffffffffffffffffff168573ffffffffffffffffffffffffffffffffffffffff161461115b57600160035f8773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f82825401925050819055505b8460025f8681526020019081526020015f205f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550838573ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a4809150509392505050565b611218610fec565b73ffffffffffffffffffffffffffffffffffffffff16611236610bc6565b73ffffffffffffffffffffffffffffffffffffffff161461129557611259610fec565b6040517f118cdaa700000000000000000000000000000000000000000000000000000000815260040161128c9190612254565b60405180910390fd5b565b5f60075f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690508160075f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b611373828260405180602001604052805f815250611b8d565b5050565b8060065f8481526020019081526020015f2090816113959190612afc565b507ff8e1a15aba9398e019f0b49df1a4fde98ee17ae345cb5f6b5e2c27f5033e8ce7826040516113c591906125e1565b60405180910390a15050565b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff160361144157816040517f5b08ba180000000000000000000000000000000000000000000000000000000081526004016114389190612254565b60405180910390fd5b8060055f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff0219169083151502179055508173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c318360405161152d919061210e565b60405180910390a3505050565b5f8373ffffffffffffffffffffffffffffffffffffffff163b11156116df578273ffffffffffffffffffffffffffffffffffffffff1663150b7a02868685856040518563ffffffff1660e01b81526004016115989493929190612df5565b6020604051808303815f875af19250505080156115d357506040513d601f19601f820116820180604052508101906115d09190612e53565b60015b611654573d805f8114611601576040519150601f19603f3d011682016040523d82523d5f602084013e611606565b606091505b505f81510361164c57836040517f64a0ae920000000000000000000000000000000000000000000000000000000081526004016116439190612254565b60405180910390fd5b805160208201fd5b63150b7a0260e01b7bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916146116dd57836040517f64a0ae920000000000000000000000000000000000000000000000000000000081526004016116d49190612254565b60405180910390fd5b505b5050505050565b60606116f182610f2d565b505f60065f8481526020019081526020015f20805461170f906128b8565b80601f016020809104026020016040519081016040528092919081815260200182805461173b906128b8565b80156117865780601f1061175d57610100808354040283529160200191611786565b820191905f5260205f20905b81548152906001019060200180831161176957829003601f168201915b505050505090505f611796611bb0565b90505f8151036117aa5781925050506117ec565b5f825111156117de5780826040516020016117c6929190612eb8565b604051602081830303815290604052925050506117ec565b6117e784611bc6565b925050505b919050565b5f7f80ac58cd000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614806118bb57507f5b5e139f000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916145b806118cb57506118ca82611c2c565b5b9050919050565b5f60025f8381526020019081526020015f205f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b808061194357505f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1614155b15611a75575f61195284610f2d565b90505f73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16141580156119bc57508273ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614155b80156119cf57506119cd8184610dbb565b155b15611a1157826040517fa9fbf51f000000000000000000000000000000000000000000000000000000008152600401611a089190612254565b60405180910390fd5b8115611a7357838573ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560405160405180910390a45b505b8360045f8581526020019081526020015f205f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050505050565b611ad5838383611c95565b611b88575f73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1603611b4957806040517f7e273289000000000000000000000000000000000000000000000000000000008152600401611b4091906125e1565b60405180910390fd5b81816040517f177e802f000000000000000000000000000000000000000000000000000000008152600401611b7f929190612edb565b60405180910390fd5b505050565b611b978383611d55565b611bab611ba2610fec565b5f85858561153a565b505050565b606060405180602001604052805f815250905090565b6060611bd182610f2d565b505f611bdb611bb0565b90505f815111611bf95760405180602001604052805f815250611c24565b80611c0384611e48565b604051602001611c14929190612eb8565b6040516020818303038152906040525b915050919050565b5f7f01ffc9a7000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916149050919050565b5f5f73ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1614158015611d4c57508273ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff161480611d0d5750611d0c8484610dbb565b5b80611d4b57508273ffffffffffffffffffffffffffffffffffffffff16611d3383610fb3565b73ffffffffffffffffffffffffffffffffffffffff16145b5b90509392505050565b5f73ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603611dc5575f6040517f64a0ae92000000000000000000000000000000000000000000000000000000008152600401611dbc9190612254565b60405180910390fd5b5f611dd183835f611005565b90505f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1614611e43575f6040517f73c6ac6e000000000000000000000000000000000000000000000000000000008152600401611e3a9190612254565b60405180910390fd5b505050565b60605f6001611e5684611f12565b0190505f8167ffffffffffffffff811115611e7457611e736123cc565b5b6040519080825280601f01601f191660200182016040528015611ea65781602001600182028036833780820191505090505b5090505f82602083010190505b600115611f07578080600190039150507f3031323334353637383961626364656600000000000000000000000000000000600a86061a8153600a8581611efc57611efb612f02565b5b0494505f8503611eb3575b819350505050919050565b5f5f5f90507a184f03e93ff9f4daa797ed6e38ed64bf6a1f0100000000000000008310611f6e577a184f03e93ff9f4daa797ed6e38ed64bf6a1f0100000000000000008381611f6457611f63612f02565b5b0492506040810190505b6d04ee2d6d415b85acef81000000008310611fab576d04ee2d6d415b85acef81000000008381611fa157611fa0612f02565b5b0492506020810190505b662386f26fc100008310611fda57662386f26fc100008381611fd057611fcf612f02565b5b0492506010810190505b6305f5e1008310612003576305f5e1008381611ff957611ff8612f02565b5b0492506008810190505b612710831061202857612710838161201e5761201d612f02565b5b0492506004810190505b6064831061204b576064838161204157612040612f02565b5b0492506002810190505b600a831061205a576001810190505b80915050919050565b5f604051905090565b5f5ffd5b5f5ffd5b5f7fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b6120a881612074565b81146120b2575f5ffd5b50565b5f813590506120c38161209f565b92915050565b5f602082840312156120de576120dd61206c565b5b5f6120eb848285016120b5565b91505092915050565b5f8115159050919050565b612108816120f4565b82525050565b5f6020820190506121215f8301846120ff565b92915050565b5f81519050919050565b5f82825260208201905092915050565b8281835e5f83830152505050565b5f601f19601f8301169050919050565b5f61216982612127565b6121738185612131565b9350612183818560208601612141565b61218c8161214f565b840191505092915050565b5f6020820190508181035f8301526121af818461215f565b905092915050565b5f819050919050565b6121c9816121b7565b81146121d3575f5ffd5b50565b5f813590506121e4816121c0565b92915050565b5f602082840312156121ff576121fe61206c565b5b5f61220c848285016121d6565b91505092915050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61223e82612215565b9050919050565b61224e81612234565b82525050565b5f6020820190506122675f830184612245565b92915050565b61227681612234565b8114612280575f5ffd5b50565b5f813590506122918161226d565b92915050565b5f5f604083850312156122ad576122ac61206c565b5b5f6122ba85828601612283565b92505060206122cb858286016121d6565b9150509250929050565b6122de816121b7565b82525050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602160045260245ffd5b60058110612322576123216122e4565b5b50565b5f81905061233282612311565b919050565b5f61234182612325565b9050919050565b61235181612337565b82525050565b5f60c08201905061236a5f8301896122d5565b818103602083015261237c818861215f565b90508181036040830152612390818761215f565b905061239f6060830186612245565b6123ac6080830185612348565b6123b960a08301846122d5565b979650505050505050565b5f5ffd5b5f5ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b6124028261214f565b810181811067ffffffffffffffff82111715612421576124206123cc565b5b80604052505050565b5f612433612063565b905061243f82826123f9565b919050565b5f67ffffffffffffffff82111561245e5761245d6123cc565b5b6124678261214f565b9050602081019050919050565b828183375f83830152505050565b5f61249461248f84612444565b61242a565b9050828152602081018484840111156124b0576124af6123c8565b5b6124bb848285612474565b509392505050565b5f82601f8301126124d7576124d66123c4565b5b81356124e7848260208601612482565b91505092915050565b5f5f604083850312156125065761250561206c565b5b5f83013567ffffffffffffffff81111561252357612522612070565b5b61252f858286016124c3565b925050602083013567ffffffffffffffff8111156125505761254f612070565b5b61255c858286016124c3565b9150509250929050565b5f5f5f6060848603121561257d5761257c61206c565b5b5f61258a86828701612283565b935050602061259b86828701612283565b92505060406125ac868287016121d6565b9150509250925092565b5f602082840312156125cb576125ca61206c565b5b5f6125d884828501612283565b91505092915050565b5f6020820190506125f45f8301846122d5565b92915050565b5f5f5f606084860312156126115761261061206c565b5b5f61261e868287016121d6565b935050602061262f868287016121d6565b925050604084013567ffffffffffffffff8111156126505761264f612070565b5b61265c868287016124c3565b9150509250925092565b61266f816120f4565b8114612679575f5ffd5b50565b5f8135905061268a81612666565b92915050565b5f5f604083850312156126a6576126a561206c565b5b5f6126b385828601612283565b92505060206126c48582860161267c565b9150509250929050565b5f67ffffffffffffffff8211156126e8576126e76123cc565b5b6126f18261214f565b9050602081019050919050565b5f61271061270b846126ce565b61242a565b90508281526020810184848401111561272c5761272b6123c8565b5b612737848285612474565b509392505050565b5f82601f830112612753576127526123c4565b5b81356127638482602086016126fe565b91505092915050565b5f5f5f5f608085870312156127845761278361206c565b5b5f61279187828801612283565b94505060206127a287828801612283565b93505060406127b3878288016121d6565b925050606085013567ffffffffffffffff8111156127d4576127d3612070565b5b6127e08782880161273f565b91505092959194509250565b600581106127f8575f5ffd5b50565b5f81359050612809816127ec565b92915050565b5f5f604083850312156128255761282461206c565b5b5f612832858286016121d6565b9250506020612843858286016127fb565b9150509250929050565b5f5f604083850312156128635761286261206c565b5b5f61287085828601612283565b925050602061288185828601612283565b9150509250929050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f60028204905060018216806128cf57607f821691505b6020821081036128e2576128e161288b565b5b50919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f61291f826121b7565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8203612951576129506128e8565b5b600182019050919050565b5f819050815f5260205f209050919050565b5f6020601f8301049050919050565b5f82821b905092915050565b5f600883026129b87fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8261297d565b6129c2868361297d565b95508019841693508086168417925050509392505050565b5f819050919050565b5f6129fd6129f86129f3846121b7565b6129da565b6121b7565b9050919050565b5f819050919050565b612a16836129e3565b612a2a612a2282612a04565b848454612989565b825550505050565b5f5f905090565b612a41612a32565b612a4c818484612a0d565b505050565b5b81811015612a6f57612a645f82612a39565b600181019050612a52565b5050565b601f821115612ab457612a858161295c565b612a8e8461296e565b81016020851015612a9d578190505b612ab1612aa98561296e565b830182612a51565b50505b505050565b5f82821c905092915050565b5f612ad45f1984600802612ab9565b1980831691505092915050565b5f612aec8383612ac5565b9150826002028217905092915050565b612b0582612127565b67ffffffffffffffff811115612b1e57612b1d6123cc565b5b612b2882546128b8565b612b33828285612a73565b5f60209050601f831160018114612b64575f8415612b52578287015190505b612b5c8582612ae1565b865550612bc3565b601f198416612b728661295c565b5f5b82811015612b9957848901518255600182019150602085019450602081019050612b74565b86831015612bb65784890151612bb2601f891682612ac5565b8355505b6001600288020188555050505b505050505050565b5f606082019050612bde5f830186612245565b612beb60208301856122d5565b612bf86040830184612245565b949350505050565b7f50726f6a65637420646f6573206e6f74206578697374000000000000000000005f82015250565b5f612c34601683612131565b9150612c3f82612c00565b602082019050919050565b5f6020820190508181035f830152612c6181612c28565b9050919050565b7f50726f6a656374206973206e6f7420617070726f7665640000000000000000005f82015250565b5f612c9c601783612131565b9150612ca782612c68565b602082019050919050565b5f6020820190508181035f830152612cc981612c90565b9050919050565b7f416d6f756e74206d7573742062652067726561746572207468616e207a65726f5f82015250565b5f612d04602083612131565b9150612d0f82612cd0565b602082019050919050565b5f6020820190508181035f830152612d3181612cf8565b9050919050565b5f819050919050565b5f612d5b612d56612d5184612d38565b6129da565b6121b7565b9050919050565b612d6b81612d41565b82525050565b5f602082019050612d845f830184612d62565b92915050565b5f602082019050612d9d5f830184612348565b92915050565b5f81519050919050565b5f82825260208201905092915050565b5f612dc782612da3565b612dd18185612dad565b9350612de1818560208601612141565b612dea8161214f565b840191505092915050565b5f608082019050612e085f830187612245565b612e156020830186612245565b612e2260408301856122d5565b8181036060830152612e348184612dbd565b905095945050505050565b5f81519050612e4d8161209f565b92915050565b5f60208284031215612e6857612e6761206c565b5b5f612e7584828501612e3f565b91505092915050565b5f81905092915050565b5f612e9282612127565b612e9c8185612e7e565b9350612eac818560208601612141565b80840191505092915050565b5f612ec38285612e88565b9150612ecf8284612e88565b91508190509392505050565b5f604082019050612eee5f830185612245565b612efb60208301846122d5565b9392505050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601260045260245ffdfea2646970667358221220592c644228542c0c3c69635af0b81f5f89b4ff8549a7ad5b5f36fb5e1527087764736f6c634300081e0033';
const marketplaceBytecode = '60a060405234801561000f575f5ffd5b5060405161108e38038061108e833981810160405281019061003191906100d0565b60015f819055508073ffffffffffffffffffffffffffffffffffffffff1660808173ffffffffffffffffffffffffffffffffffffffff1681525050506100fb565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61009f82610076565b9050919050565b6100af81610095565b81146100b9575f5ffd5b50565b5f815190506100ca816100a6565b92915050565b5f602082840312156100e5576100e4610072565b5b5f6100f2848285016100bc565b91505092915050565b608051610f6d6101215f395f8181610123015281816102e101526106ca0152610f6d5ff3fe608060405260043610610049575f3560e01c8063151ed0911461004d578063305a67a8146100775780634fbf39291461009f5780637211dde4146100c7578063de74e57b146100e3575b5f5ffd5b348015610058575f5ffd5b50610061610121565b60405161006e9190610954565b60405180910390f35b348015610082575f5ffd5b5061009d600480360381019061009891906109a4565b610145565b005b3480156100aa575f5ffd5b506100c560048036038101906100c091906109cf565b61029c565b005b6100e160048036038101906100dc91906109a4565b6105d5565b005b3480156100ee575f5ffd5b50610109600480360381019061010491906109a4565b61086e565b60405161011893929190610a36565b60405180910390f35b7f000000000000000000000000000000000000000000000000000000000000000081565b5f60015f8381526020019081526020015f209050806002015f9054906101000a900460ff166101a9576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016101a090610aeb565b60405180910390fd5b3373ffffffffffffffffffffffffffffffffffffffff16815f015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614610239576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161023090610b79565b60405180910390fd5b5f816002015f6101000a81548160ff0219169083151502179055503373ffffffffffffffffffffffffffffffffffffffff16827f8e25282255ab31897df2b0456bb993ac7f84d376861aefd84901d2d63a7428a260405160405180910390a35050565b5f81116102de576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016102d590610be1565b60405180910390fd5b5f7f000000000000000000000000000000000000000000000000000000000000000090503373ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16636352211e856040518263ffffffff1660e01b81526004016103529190610bff565b602060405180830381865afa15801561036d573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906103919190610c42565b73ffffffffffffffffffffffffffffffffffffffff16146103e7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016103de90610cdd565b60405180910390fd5b3073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1663081812fc856040518263ffffffff1660e01b81526004016104379190610bff565b602060405180830381865afa158015610452573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906104769190610c42565b73ffffffffffffffffffffffffffffffffffffffff16146104cc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016104c390610d6b565b60405180910390fd5b60405180606001604052803373ffffffffffffffffffffffffffffffffffffffff1681526020018381526020016001151581525060015f8581526020019081526020015f205f820151815f015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550602082015181600101556040820151816002015f6101000a81548160ff0219169083151502179055509050503373ffffffffffffffffffffffffffffffffffffffff16837f4ac0e51fccbcff90e2efa701b77c9cccff85e9345e1d32c94e7e785993b195c4846040516105c89190610bff565b60405180910390a3505050565b6105dd6108bf565b5f60015f8381526020019081526020015f209050806002015f9054906101000a900460ff16610641576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161063890610aeb565b60405180910390fd5b80600101543414610687576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161067e90610dd3565b60405180910390fd5b5f815f015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690505f826002015f6101000a81548160ff0219169083151502179055507f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff166323b872dd8233866040518463ffffffff1660e01b815260040161072593929190610df1565b5f604051808303815f87803b15801561073c575f5ffd5b505af115801561074e573d5f5f3e3d5ffd5b505050505f8173ffffffffffffffffffffffffffffffffffffffff163460405161077790610e53565b5f6040518083038185875af1925050503d805f81146107b1576040519150601f19603f3d011682016040523d82523d5f602084013e6107b6565b606091505b50509050806107fa576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016107f190610eb1565b60405180910390fd5b3373ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16857f7e47a1e6c94fa983ca28d7705e8a571d166221513a37da6b741dd937d16dfb11346040516108589190610bff565b60405180910390a450505061086b61090c565b50565b6001602052805f5260405f205f91509050805f015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690806001015490806002015f9054906101000a900460ff16905083565b60025f5403610903576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016108fa90610f19565b60405180910390fd5b60025f81905550565b60015f81905550565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61093e82610915565b9050919050565b61094e81610934565b82525050565b5f6020820190506109675f830184610945565b92915050565b5f5ffd5b5f819050919050565b61098381610971565b811461098d575f5ffd5b50565b5f8135905061099e8161097a565b92915050565b5f602082840312156109b9576109b861096d565b5b5f6109c684828501610990565b91505092915050565b5f5f604083850312156109e5576109e461096d565b5b5f6109f285828601610990565b9250506020610a0385828601610990565b9150509250929050565b610a1681610971565b82525050565b5f8115159050919050565b610a3081610a1c565b82525050565b5f606082019050610a495f830186610945565b610a566020830185610a0d565b610a636040830184610a27565b949350505050565b5f82825260208201905092915050565b7f5468697320637265646974206973206e6f74206c697374656420666f722073615f8201527f6c65000000000000000000000000000000000000000000000000000000000000602082015250565b5f610ad5602283610a6b565b9150610ae082610a7b565b604082019050919050565b5f6020820190508181035f830152610b0281610ac9565b9050919050565b7f596f7520617265206e6f74207468652073656c6c6572206f66207468697320635f8201527f7265646974000000000000000000000000000000000000000000000000000000602082015250565b5f610b63602583610a6b565b9150610b6e82610b09565b604082019050919050565b5f6020820190508181035f830152610b9081610b57565b9050919050565b7f5072696365206d7573742062652067726561746572207468616e207a65726f005f82015250565b5f610bcb601f83610a6b565b9150610bd682610b97565b602082019050919050565b5f6020820190508181035f830152610bf881610bbf565b9050919050565b5f602082019050610c125f830184610a0d565b92915050565b610c2181610934565b8114610c2b575f5ffd5b50565b5f81519050610c3c81610c18565b92915050565b5f60208284031215610c5757610c5661096d565b5b5f610c6484828501610c2e565b91505092915050565b7f596f7520617265206e6f7420746865206f776e6572206f6620746869732063725f8201527f6564697400000000000000000000000000000000000000000000000000000000602082015250565b5f610cc7602483610a6b565b9150610cd282610c6d565b604082019050919050565b5f6020820190508181035f830152610cf481610cbb565b9050919050565b7f4d61726b6574706c616365206e6f7420617070726f76656420746f206d616e615f8201527f6765207468697320637265646974000000000000000000000000000000000000602082015250565b5f610d55602e83610a6b565b9150610d6082610cfb565b604082019050919050565b5f6020820190508181035f830152610d8281610d49565b9050919050565b7f496e636f72726563742045544820616d6f756e742073656e74000000000000005f82015250565b5f610dbd601983610a6b565b9150610dc882610d89565b602082019050919050565b5f6020820190508181035f830152610dea81610db1565b9050919050565b5f606082019050610e045f830186610945565b610e116020830185610945565b610e1e6040830184610a0d565b949350505050565b5f81905092915050565b50565b5f610e3e5f83610e26565b9150610e4982610e30565b5f82019050919050565b5f610e5d82610e33565b9150819050919050565b7f4661696c656420746f2073656e642066756e647320746f2073656c6c657200005f82015250565b5f610e9b601e83610a6b565b9150610ea682610e67565b602082019050919050565b5f6020820190508181035f830152610ec881610e8f565b9050919050565b7f5265656e7472616e637947756172643a207265656e7472616e742063616c6c005f82015250565b5f610f03601f83610a6b565b9150610f0e82610ecf565b602082019050919050565b5f6020820190508181035f830152610f3081610ef7565b905091905056fea264697066735822122046a67c697db82f36ab21bbfeaa4256b78fd6c8e1dc9d6d4b2c0076de1110723764736f6c634300081e0033';

// --- DEPLOYMENT LOGIC ---
async function main() {
  const provider = new ethers.JsonRpcProvider(process.env.GANACHE_URL);
  const wallet = new ethers.Wallet(process.env.GANACHE_PRIVATE_KEY, provider);

  console.log(`ðŸ“¡ Deploying contracts with the account: ${wallet.address}`);

  // 1. Deploy the BlueCarbonRegistry contract
  const RegistryFactory = new ethers.ContractFactory(registryABI, registryBytecode, wallet);
  console.log('Deploying BlueCarbonRegistry...');
  
  // THE FIX IS HERE: The parentheses are empty because your constructor is empty.
  const registry = await RegistryFactory.deploy(); 
  
  await registry.waitForDeployment();
  const registryAddress = await registry.getAddress();
  console.log(`âœ… BlueCarbonRegistry deployed to: ${registryAddress}`);

  // 2. Deploy the CarbonCreditMarketplace contract
  const MarketplaceFactory = new ethers.ContractFactory(marketplaceABI, marketplaceBytecode, wallet);
  console.log('Deploying CarbonCreditMarketplace...');
  // IMPORTANT: This assumes your marketplace constructor needs the registry address.
  // If it does not, change .deploy(registryAddress) to .deploy()
  const marketplace = await MarketplaceFactory.deploy(registryAddress);
  await marketplace.waitForDeployment();
  const marketplaceAddress = await marketplace.getAddress();
  console.log(`âœ… CarbonCreditMarketplace deployed to: ${marketplaceAddress}`);

  console.log("\nâœ¨ Deployment complete! Copy these addresses for the next step.");
}

main().catch((error) => {
  console.error('ðŸ’¥ Error deploying contracts:', error);
  process.exit(1);
});